var forge = require('node-forge');

// Returns SHA1-digest (160 bits) of message
// The output is a strings with the hex-encoded digest.
exports.hash = function hash(message) {
    var md = forge.md.sha1.create()
    md.update(message, 'utf8');
    return md.digest().toHex();
}

// Returns a 160-bit random value (hex-encoded)
exports.nonce = function nonce() {
    return forge.util.bytesToHex(forge.random.getBytesSync(20));
}

